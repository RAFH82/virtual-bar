(this["webpackJsonpslack-clone"]=this["webpackJsonpslack-clone"]||[]).push([[0],{119:function(e,t,a){},127:function(e,t,a){},128:function(e,t,a){},131:function(e,t,a){},136:function(e,t,a){},137:function(e,t,a){},138:function(e,t,a){},139:function(e,t,a){},140:function(e,t,a){},141:function(e,t,a){},142:function(e,t,a){},143:function(e,t,a){},144:function(e,t,a){},145:function(e,t,a){"use strict";a.r(t);var n=a(3),c=a(1),o=a.n(c),i=a(17),r=a.n(i),s=(a(119),a(10)),l=a(37),d=a(19),b=Object(c.createContext)(),u=function(e){var t=e.reducer,a=e.initialState,o=e.children;return Object(n.jsx)(b.Provider,{value:Object(c.useReducer)(t,a),children:o})},j=function(){return Object(c.useContext)(b)},h=a(16);var p=a(76),m=a.n(p),O=a(86),f=h.a.initializeApp({apiKey:"AIzaSyAZtTYp-SCK5E7bZ2jZtGtH_ZqRAWIn7AU",authDomain:"virtual-bar-9a045.firebaseapp.com",projectId:"virtual-bar-9a045",storageBucket:"virtual-bar-9a045.appspot.com",messagingSenderId:"1053209643695",appId:"1:1053209643695:web:262d567469c7f8cbc9e25a"}).firestore(),g=h.a.auth(),x=new h.a.auth.GoogleAuthProvider,v=f;var _=a(41),y=a(182),k=a(190),N=a(147),w=a(191),C=a(192),S=a(207),I=a(185),T=a(187),D=a(205),F=a(189),R=a(59),B=Object(y.a)((function(e){return{root:{flexGrow:1,minWidth:300,maxWidth:400,maxHeight:700},demo:{backgroundColor:e.palette.background.paper},title:{margin:e.spacing(4,0,2)},primary_text:{display:"flex",fontSize:20,fontWeight:"bold",fontStyle:"italic"},bar_text:{display:"inline-block",fontWeight:"bold",fontSize:18,marginRight:4},table_text:{display:"inline-block",fontWeight:"bold",fontSize:18,marginRight:4},checkbox:{color:"#311f34","&$checked":{color:"#311f34"}}}}));function E(e){var t=e.friendsList,a=B(),o=Object(c.useState)(!1),i=Object(s.a)(o,2),r=i[0],l=(i[1],Object(c.useState)(!1)),d=Object(s.a)(l,2),b=d[0],u=d[1],j=Object(c.useState)([]),p=Object(s.a)(j,2),m=p[0],O=p[1];return Object(c.useEffect)((function(){v.collection("users").where(h.a.firestore.FieldPath.documentId(),"in",t).where("state","==","online").onSnapshot((function(e){O(e.docs.map((function(e){return e.data()})))}))}),[]),Object(n.jsxs)("div",{className:a.root,children:[Object(n.jsx)(I.a,{row:!0,children:Object(n.jsx)(T.a,{className:a.checkbox,control:Object(n.jsx)(D.a,{className:a.checkbox,checked:b,onChange:function(e){return u(e.target.checked)},color:""}),label:"Location"})}),Object(n.jsx)(F.a,{container:!0,spacing:2,children:Object(n.jsx)(F.a,{item:!0,xs:12,md:13,children:Object(n.jsx)("div",{className:a.demo,children:Object(n.jsx)(k.a,{dense:r,children:m.map((function(e){return Object(n.jsxs)(N.a,{children:[Object(n.jsx)(w.a,{children:Object(n.jsx)(S.a,{src:null===e||void 0===e?void 0:e.profile_image})}),Object(n.jsx)(C.a,{disableTypography:!0,primary:Object(n.jsx)(R.a,{className:a.primary_text,children:null===e||void 0===e?void 0:e.username}),secondary:b?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(R.a,{className:a.bar_text,children:"Bar: "}),null===e||void 0===e?void 0:e.at_bar_name,Object(n.jsx)("br",{}),Object(n.jsx)(R.a,{className:a.table_text,children:"Table: "}),null===e||void 0===e?void 0:e.at_table_name]}):Object(n.jsx)(n.Fragment,{})})]})}))})})})})]})}var W=a(204),A=a(193),L=(a(127),Object(y.a)((function(e){return{typography:{padding:e.spacing(2)},bar__button:{position:"relative",top:12,backgroundColor:"#000",color:"#fff","&:hover":{background:"#fff",color:"#000"}}}})));function z(){var e=j(),t=Object(s.a)(e,1)[0].user,a=Object(c.useState)([]),o=Object(s.a)(a,2),i=o[0],r=o[1],l=L(),d=Object(c.useState)(null),b=Object(s.a)(d,2),u=b[0],h=b[1];Object(c.useEffect)((function(){v.collection("users").doc(t.uid).onSnapshot((function(e){r(e.data().friends)}))}),[t]);var p=Boolean(u),m=p?"simple-popover":void 0;return Object(n.jsxs)("div",{children:[Object(n.jsx)(A.a,{className:l.bar__button,disableFocusRipple:!0,disableRipple:!0,"aria-describedby":m,variant:"contained",color:"primary",onClick:function(e){h(e.currentTarget)},children:"Online Friends"}),Object(n.jsx)(W.a,{id:m,open:p,anchorEl:u,onClose:function(){h(null)},anchorReference:"anchorPosition",anchorPosition:{top:50,left:1365},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(n.jsx)(R.a,{className:l.typography,children:Object(n.jsx)(E,{friendsList:i})})})]})}var M=a(20),V=a(195),U=a(196),G=a(188),Y=a(194),P=a(96),H=a(91),Z=a.n(H),J=a(90),q=a.n(J),K=a.p+"static/media/cocktail.27c40d7c.png",X=(a(128),a.p+"static/media/shattered.6e5e9717.png"),$=Object(y.a)((function(e){return{toolbar:{backgroundColor:"#1e0521",boxShadow:"inset 0 0 0 2000px rgba(30, 5, 33, 0.6)",backgroundImage:"url(".concat(X,")")},grow:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:Object(_.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(_.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(M.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(M.c)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(_.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:"20ch"}),sectionDesktop:Object(_.a)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),sectionMobile:Object(_.a)({display:"flex"},e.breakpoints.up("md"),{display:"none"})}}));var Q=function(){var e=j(),t=Object(s.a)(e,1)[0].user,a=Object(d.f)(),c=o.a.useState(null),i=Object(s.a)(c,2),r=i[0],l=i[1],b=o.a.useState(null),u=Object(s.a)(b,2),h=u[0],p=u[1],m=$(),O="primary-search-account-menu",f=Boolean(r),g=Boolean(h),x=function(){p(null)},v=function(e){e.preventDefault(),a.push("/")},_=function(){window.location.reload(!1)},y=Object(n.jsx)(P.a,{anchorEl:r,anchorReference:"anchorPosition",anchorPosition:{top:60,left:1655},anchorOrigin:{vertical:"top",horizontal:"right"},id:O,keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:f,onClose:function(){l(null),x()},children:Object(n.jsx)(Y.a,{onClick:_,children:"Logout"})}),k="primary-search-account-menu-mobile",N=Object(n.jsx)(P.a,{anchorEl:h,anchorOrigin:{vertical:"top",horizontal:"right"},id:k,keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:g,onClose:x,children:Object(n.jsx)(Y.a,{onClick:_,children:"Logout"})});return Object(n.jsxs)("div",{className:m.grow,children:[Object(n.jsx)(V.a,{position:"static",children:Object(n.jsxs)(U.a,{className:m.toolbar,children:[Object(n.jsx)(R.a,{className:m.title,onClick:v,variant:"h6",noWrap:!0,children:Object(n.jsx)("div",{className:"nav__title",children:"VIRTUAL BAR"})}),Object(n.jsx)("div",{onClick:v,className:"nav__cocktail",children:Object(n.jsx)("img",{src:K})}),Object(n.jsx)("div",{className:m.grow}),Object(n.jsxs)("div",{className:m.sectionDesktop,children:[Object(n.jsx)(z,{}),Object(n.jsxs)(G.a,{edge:"end","aria-label":"account of current user","aria-controls":O,"aria-haspopup":"true",onClick:function(e){l(e.currentTarget)},color:"inherit",children:[Object(n.jsx)("div",{className:"icon__online",children:Object(n.jsx)(q.a,{})}),Object(n.jsx)(R.a,{className:(m.title,"avatar__name"),variant:"h6",noWrap:!0,children:null===t||void 0===t?void 0:t.displayName}),Object(n.jsx)(S.a,{className:"header__avatar",alt:null===t||void 0===t?void 0:t.displayName,src:null===t||void 0===t?void 0:t.photoURL})]})]}),Object(n.jsx)("div",{className:m.sectionMobile,children:Object(n.jsx)(G.a,{"aria-label":"show more","aria-controls":k,"aria-haspopup":"true",onClick:function(e){p(e.currentTarget)},color:"inherit",children:Object(n.jsx)(Z.a,{})})})]})}),N,y]})},ee=a(45),te="SET_USER",ae="SET_BAR_AND_TABLE",ne="LEAVE_BAR_OR_TABLE",ce=function(e,t){switch(t.type){case te:return Object(ee.a)(Object(ee.a)({},e),{},{user:t.user,userLocation:t.location,idToken:t.idToken});case ae:return Object(ee.a)(Object(ee.a)({},e),{},{at_bar:t.at_bar,at_table:t.at_table,last_bar:t.at_bar,last_table:t.at_table});case ne:return Object(ee.a)(Object(ee.a)({},e),{},{at_bar:t.at_bar,at_table:t.at_table});default:return e}},oe=(a(131),a(132));var ie=function(e){var t,a,c,o=e.message,i=e.whisper_part1,r=e.whisper_part2,s=e.user,l=e.timestamp,d=e.userImage,b=e.iSent,u=e.whisper,j=new Date(null===l||void 0===l?void 0:l.toDate()).toUTCString(),h="";return h=b?h.concat("message__bubble bubble__lip "):h.concat("message__bubble__alt bubble__lip__alt "),u&&(h=h.concat("whisper__bubble")),Object(n.jsxs)("div",{className:"message container",children:[Object(n.jsx)("img",{src:d,alt:""}),Object(n.jsxs)("div",{className:"message__info",children:[Object(n.jsxs)("p",{children:[Object(n.jsx)("b",{children:s}),Object(n.jsx)("span",{className:"message__timestamp",children:(t=j,a="Europe/London",c=oe.tz.guess(),oe.tz(t,a).tz(c).format("YYYY-MM-DD LT"))})]}),Object(n.jsxs)("div",{className:h,children:[Object(n.jsx)("p",{children:o}),Object(n.jsx)("p",{className:"msg__part1",children:i}),Object(n.jsx)("p",{children:r})]})]})]})},re=a(203),se=(a(136),Object(y.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),width:"99%"}}}})));var le=function(e){var t=e.barId,a=e.tableId,o=e.tableNumber,i=j(),r=Object(s.a)(i,1)[0].user,l=Object(c.useState)(""),d=Object(s.a)(l,2),b=d[0],u=d[1],p=Object(c.useState)(""),m=Object(s.a)(p,2),O=m[0],f=m[1],g=se();return Object(c.useEffect)((function(){var e=["Who has better arms? The Rock, or Michelle Oboma? Discuss...","This one time at band camp...","Would you ever sing with a banana at the dinner table?","Tell your best Chuck Norris joke...","What are you going to do this weekend?","Is a hotdog a sandwich? Why or why not?","Is cereal soup? Why or why not?","What\u2019s the best type of cheese?","How many chickens would it take to kill an elephant?","What\u2019s the best inside joke you\u2019ve been a part of?","What would the world be like if it was filled with male and female copies of you?","Where was the most inappropriate / most embarrassing place you\u2019ve farted?","What is the weirdest thing you have seen in someone else\u2019s home?","Convince everyone to play shot-glass checkers with you on Zoom!"];f(e[Math.floor(Math.random()*e.length)])}),[]),Object(c.useEffect)((function(){""!==b?v.collection("bars").doc(t).collection("tables").doc(a).collection("usersAtTable").doc(r.uid).update({isTyping:!0}):v.collection("bars").doc(t).collection("tables").doc(a).collection("usersAtTable").doc(r.uid).update({isTyping:!1})}),[b]),Object(n.jsx)("div",{className:"chatInput",children:Object(n.jsxs)("form",{className:g.root,noValidate:!0,autoComplete:"off",children:[Object(n.jsx)(re.a,{id:"outlined-basic",label:O,variant:"outlined",value:b,onChange:function(e){return u(e.target.value)},placeholder:"Message Table ".concat(o)}),Object(n.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),b&&(v.collection("bars").doc(t).collection("tables").doc(a).collection("messages").add({message:b,timestamp:h.a.firestore.FieldValue.serverTimestamp(),user:r.displayName,recipient:["all"],userImage:r.photoURL}),v.collection("bars").doc(t).collection("tables").doc(a).collection("usersAtTable").doc(r.uid).update({isTyping:!1})),u("")}})]})})},de=(a(137),a(92)),be=a.n(de),ue=a(93),je=a.n(ue),he=Object(y.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),width:"25ch"}},typography:{padding:e.spacing(2)},link:{display:"flex"},icon:{marginRight:e.spacing(.5),width:20,height:20}}}));var pe=function(e){var t=e.recipientName,a=e.barId,o=e.tableId,i=e.uid,r=Object(c.useState)(""),l=Object(s.a)(r,2),d=l[0],b=l[1],u=j(),p=Object(s.a)(u,1)[0].user,m=Object(c.useState)(null),O=Object(s.a)(m,2),f=O[0],g=O[1],x=he(),_=function(){g(null)},y=Boolean(f),k=y?"simple-popover":void 0;return Object(n.jsxs)("div",{className:"whisperInput",children:[Object(n.jsxs)("div",{className:"whisper__tooltip",children:[Object(n.jsx)(be.a,{className:"whisper__button",id:"form_close",variant:"contained",style:{color:je.a},onClick:function(e){g(e.currentTarget)},disableFocusRipple:!0,disableRipple:!0}),Object(n.jsxs)("span",{className:"tooltiptext",children:["Whisper ",t]})]}),Object(n.jsx)(W.a,{id:k,open:y,anchorEl:f,onClose:_,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(n.jsx)(R.a,{className:x.typography,children:Object(n.jsxs)("form",{className:x.root,noValidate:!0,autoComplete:"off",children:[Object(n.jsx)(re.a,{id:"outlined-basic",label:"Whisper ".concat(t),variant:"outlined",onChange:function(e){return b(e.target.value)},value:d}),Object(n.jsx)("div",{children:Object(n.jsx)("button",{id:"input__whisper__box",type:"submit",onClick:function(e){e.preventDefault(),d&&(v.collection("bars").doc(a).collection("tables").doc(o).collection("messages").add({whisper_part1:"(Whisper from ".concat(p.displayName,")"),whisper_part2:"".concat(d),timestamp:h.a.firestore.FieldValue.serverTimestamp(),user:p.displayName,recipient:[i],userImage:p.photoURL}),v.collection("bars").doc(a).collection("tables").doc(o).collection("messages").add({whisper_part1:"(Whisper to ".concat(t,")"),whisper_part2:"".concat(d),timestamp:h.a.firestore.FieldValue.serverTimestamp(),user:p.displayName,recipient:[p.uid],userImage:p.photoURL})),b(""),_()}})})]})})})]})},me=a(94),Oe=a.n(me),fe=(a(138),Object(y.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),width:"25ch"}}}})));var ge=function(e){var t=e.friendID,a=j(),c=Object(s.a)(a,1)[0].user;return fe(),Object(n.jsxs)("div",{className:"add-friend",children:[Object(n.jsx)(Oe.a,{onClick:function(e){e.preventDefault(),v.collection("users").doc(c.uid).update({friends:h.a.firestore.FieldValue.arrayUnion(t)})}}),Object(n.jsx)("span",{className:"tooltiptext",children:"Add as friend"})]})},xe=(a(139),Object(y.a)((function(e){return{typography:{padding:e.spacing(2)},bar__button:{margin:0,position:"relative",backgroundColor:"#311f34",color:"#FFDC14","&:hover":{background:"#FFDC14",color:"#311f34"}}}})));var ve=function(){var e=j(),t=Object(s.a)(e,2),a=t[0].user,o=t[1],i=Object(d.g)(),r=i.barId,l=i.tableId,b=Object(d.f)(),u=Object(c.useState)(null),h=Object(s.a)(u,2),p=h[0],m=h[1],O=Object(c.useState)([]),f=Object(s.a)(O,2),g=f[0],x=f[1],_=Object(c.useState)([]),y=Object(s.a)(_,2),k=y[0],N=y[1],w=Object(c.useState)([]),C=Object(s.a)(w,2),I=C[0],T=C[1],D=Object(c.useState)([]),F=Object(s.a)(D,2),R=F[0],B=F[1],E=xe(),W=Object(c.useRef)(null);Object(c.useEffect)((function(){W.current.scrollIntoView({behavior:"smooth"})}),[g]);var L=new Date,z=new Date(L-12e4);return Object(c.useEffect)((function(){v.collection("users").doc(a.uid).onSnapshot((function(e){B(e.data().friends)}))}),[a]),Object(c.useEffect)((function(){l&&v.collection("bars").doc(r).collection("tables").doc(l).onSnapshot((function(e){m(e.data())})),v.collection("bars").doc(r).collection("tables").doc(l).collection("messages").where("recipient","array-contains-any",["all",a.uid]).where("timestamp",">=",z).orderBy("timestamp","asc").onSnapshot((function(e){x(e.docs.map((function(e){return e.data()})))})),v.collection("bars").doc(r).collection("tables").doc(l).collection("usersAtTable").doc(a.uid).set({name:null===a||void 0===a?void 0:a.displayName,photoURL:null===a||void 0===a?void 0:a.photoURL,uid:null===a||void 0===a?void 0:a.uid,isTyping:!1}),v.collection("bars").doc(r).collection("tables").doc(l).collection("usersAtTable").onSnapshot((function(e){N(e.docs.map((function(e){return e.data()})))})),v.collection("bars").doc(r).onSnapshot((function(e){T(e.data())})),o({type:ae,at_table:l,at_bar:r})}),[l]),Object(n.jsxs)("div",{className:"table_chat",children:[Object(n.jsxs)("div",{className:"table_users",children:[Object(n.jsx)("div",{className:"table_users_header",children:Object(n.jsx)("h3",{children:I.name})}),Object(n.jsxs)("div",{className:"table_users_list table_you",children:[Object(n.jsx)("h4",{children:"Welcome!"}),Object(n.jsx)(c.Fragment,{children:Object(n.jsx)("ul",{children:Object(n.jsxs)("li",{className:"userName",children:[Object(n.jsx)(S.a,{className:"header__avatar",alt:a.displayName,src:a.photoURL}),Object(n.jsx)("h5",{children:a.displayName})]})})})]}),Object(n.jsxs)("div",{className:"table_users_list table_friends",children:[(null===R||void 0===R?void 0:R.length)>0&&Object(n.jsx)("h4",{children:"Friends here"}),Object(n.jsx)("ul",{children:k.map((function(e){var t=e.name,a=e.photoURL,o=e.uid,i=e.isTyping;return Object(n.jsx)(c.Fragment,{children:(null===R||void 0===R?void 0:R.includes(o))?Object(n.jsxs)("li",{className:"userName",children:[Object(n.jsx)(pe,{barId:r,tableId:l,uid:o,recipientName:t}),Object(n.jsx)(S.a,{className:"header__avatar",alt:t,src:a}),Object(n.jsx)("h5",{children:t}),i?Object(n.jsx)("i",{children:Object(n.jsx)("h5",{children:"is typing..."})}):Object(n.jsx)("p",{})]}):Object(n.jsx)("p",{})})}))})]}),Object(n.jsxs)("div",{className:"table_users_list table_strangers",children:[k&&Object(n.jsx)("h4",{children:"Others hanging out"}),Object(n.jsx)("ul",{children:k.map((function(e){var t=e.name,o=e.photoURL,i=e.uid,s=e.isTyping;return Object(n.jsx)(c.Fragment,{children:(null===R||void 0===R?void 0:R.includes(i))||i==a.uid?Object(n.jsx)("p",{}):Object(n.jsxs)("li",{className:"userName",children:[Object(n.jsx)(pe,{barId:r,tableId:l,uid:i,recipientName:t}),Object(n.jsx)(S.a,{className:"header__avatar",alt:t,src:o}),Object(n.jsx)("h5",{children:t}),Object(n.jsx)(ge,{friendID:i}),s?Object(n.jsx)("i",{children:Object(n.jsx)("h5",{children:"is typing..."})}):Object(n.jsx)("p",{})]})})}))})]})]}),Object(n.jsxs)("div",{className:"chat",children:[Object(n.jsxs)("div",{className:"chat__header",children:[Object(n.jsx)("div",{className:"chat__headerLeft",children:Object(n.jsx)("h4",{className:"chat__channelName",children:Object(n.jsxs)("strong",{children:["Hanging at ",null===p||void 0===p?void 0:p.name]})})}),Object(n.jsx)("div",{className:"chat__headerRight",children:Object(n.jsx)(A.a,{className:E.bar__button,disableFocusRipple:!0,disableRipple:!0,variant:"contained",color:"primary",onClick:function(){v.collection("bars").doc(r).collection("tables").doc(l).collection("usersAtTable").doc(a.uid).delete();b.push("/bar/".concat(r))},children:"Leave Table"})})]}),Object(n.jsx)("div",{className:"chat__messages",children:g.map((function(e){return Object(n.jsx)(ie,{iSent:e.user===a.displayName,whisper:"all"!==e.recipient[0],message:e.message,whisper_part1:e.whisper_part1,whisper_part2:e.whisper_part2,timestamp:e.timestamp,user:e.user,userImage:e.userImage})}))}),Object(n.jsx)("div",{className:"scroll-spacer",ref:W}),Object(n.jsx)(le,{barId:r,tableId:l,tableNumber:null===p||void 0===p?void 0:p.name})]})]})},_e=a(70),ye=a.n(_e),ke=(a(140),a.p+"static/media/logo2.88c1d0ef.png");var Ne=function(){var e=j(),t=Object(s.a)(e,2),a=(t[0],t[1]),c=Object(d.f)();return Object(n.jsxs)("div",{className:"login",children:[Object(n.jsx)("img",{src:ke,width:1200}),Object(n.jsxs)("div",{className:"login__container",children:[Object(n.jsx)("img",{classname:"icon",src:K}),Object(n.jsx)("h1",{children:"Welcome to Virtual Bar"}),Object(n.jsx)(A.a,{id:"neon-btn",className:"btn two",onClick:function(){g.signInWithPopup(x).then((function(e){var t=e.user.uid;ye.a.isGeolocationAvailable().then((function(n){var c={latitude:n.coords.latitude,longitude:n.coords.longitude};a({type:te,user:e.user,location:c,idToken:t})})),c.replace("/")})).catch((function(e){alert(e.message)}))},children:"Sign in with Google"})]})]})},we=a(197),Ce=a(198),Se=a(201),Ie=a(200),Te=a(199),De=(a(85),Object(y.a)({root:{maxWidth:345,minWidth:345,marginTop:15,marginBottom:15,backgroundColor:"#311f34",boxShadow:"4px 4px 5px 0px rgba(50, 50, 50, 0.9)"},media:{height:250},bar__button:{color:"#FFDC14","&:hover":{background:"#FFDC14",color:"#311f34",boxShadow:"10px 10px 99px 6px #ffdc14"}}}));var Fe=function(e){var t,a,c=e.title,o=e.id,i=e.description,r=e.barCreatorId,l=e.photo,b=Object(d.f)(),u=j(),h=Object(s.a)(u,1)[0].idToken,p=De(),m=function(){o?b.push("/bar/".concat(o)):b.push(c)};return Object(n.jsxs)(we.a,{className:p.root,children:[Object(n.jsxs)(Ce.a,{onClick:m,children:[Object(n.jsx)(Te.a,{className:p.media,image:l||"https://images.unsplash.com/photo-1575444758702-4a6b9222336e?ixid=MXwxMjA3fDB8MHxzZWFyY2h8M3x8YmFyfGVufDB8fDB8&ixlib=rb-1.2.1&w=1000&q=80",title:c}),Object(n.jsxs)(Ie.a,{children:[Object(n.jsx)(R.a,{gutterBottom:!0,variant:"h5",component:"h2",children:c}),Object(n.jsx)(R.a,{variant:"body2",color:"textSecondary",component:"p",children:i})]})]}),Object(n.jsxs)(Se.a,{children:[Object(n.jsx)(A.a,{className:p.bar__button,size:"small",color:"primary",onClick:m,children:"Join Bar"}),(t=r,a=h,t===a&&Object(n.jsx)(A.a,{className:p.bar__button,size:"small",color:"primary",onClick:function(){window.confirm("Are you sure you want to delete the bar?")&&v.collection("bars").doc(o).delete()},children:"Delete Bar"}))]})]})},Re=a(206),Be=a(202),Ee=a(71),We=a.n(Ee),Ae=(a(141),Object(y.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),width:"25ch"}},typography:{padding:e.spacing(2)},link:{display:"flex"},icon:{marginRight:e.spacing(.5),width:20,height:20},bar__button:{backgroundColor:"#311f34",color:"#FFDC14","&:hover":{background:"#FFDC14",color:"#311f34"}}}})));var Le=function(){var e,t=Object(c.useState)([]),a=Object(s.a)(t,2),o=a[0],i=a[1],r=j(),l=Object(s.a)(r,2),d=l[0],b=d.userLocation,u=d.idToken,p=l[1],m=Object(c.useState)(null),O=Object(s.a)(m,2),f=O[0],g=O[1],x=Object(c.useState)(""),_=Object(s.a)(x,2),y=_[0],k=_[1],N=Object(c.useState)(""),w=Object(s.a)(N,2),C=w[0],S=w[1],I=Object(c.useState)(""),T=Object(s.a)(I,2),D=T[0],F=T[1],B=Ae();Object(c.useEffect)((function(){v.collection("bars").orderBy("name","asc").onSnapshot((function(e){i(e.docs.map((function(e){return{id:e.id,name:e.data().name,creatorId:e.data().creatorId,photo:e.data().photo_url,location:{latitude:e.data().location.latitude,longitude:e.data().location.longitude},description:e.data().description}})))})),p({type:ne,at_table:null,at_bar:null})}),[]);var E=function(){g(null)},L=Boolean(f),z=L?"simple-popover":void 0;return Object(n.jsx)(c.Fragment,{children:Object(n.jsxs)("div",{className:"street",children:[Object(n.jsxs)(Re.a,{"aria-label":"breadcrumb",className:"breadCrumbs",children:[Object(n.jsxs)(Be.a,{color:"inherit",className:B.link,children:[Object(n.jsx)(We.a,{className:B.icon}),"Bars Nearby"]}),Object(n.jsx)(A.a,{className:"".concat(B.bar__button,' "button__open_new_bar"'),id:"form_close",variant:"contained",color:"primary",onClick:function(e){g(e.currentTarget)},disableFocusRipple:!0,disableRipple:!0,children:"Open New Bar"})]}),Object(n.jsx)(W.a,{id:z,open:L,anchorEl:f,onClose:E,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(n.jsx)(R.a,{className:B.typography,children:Object(n.jsxs)("form",{className:B.root,noValidate:!0,autoComplete:"off",children:[Object(n.jsx)(re.a,{id:"outlined-basic",label:"Enter your bar's name",variant:"outlined",onChange:function(e){return k(e.target.value)},value:y}),Object(n.jsx)(re.a,{id:"outlined-basic",label:"Enter a description",variant:"outlined",onChange:function(e){return S(e.target.value)},value:C}),Object(n.jsx)(re.a,{id:"outlined-basic",label:"Enter an image URL",variant:"outlined",onChange:function(e){return F(e.target.value)},value:D}),Object(n.jsx)("div",{children:Object(n.jsx)("button",{id:"input__bar_box",type:"submit",onClick:function(e){e.preventDefault(),y?(y&&v.collection("bars").add({table_size:6,capacity:60,name:y,creatorId:u,description:C||"Your standard generic watering hole",photo_url:D||null,location:new h.a.firestore.GeoPoint(b.latitude,b.longitude)}),F(""),k(""),S(""),E()):alert("You must give your bar a name")}})})]})})}),Object(n.jsxs)("div",{className:"bar_list",children:[o.map((function(t){return function(e){var t=[{latitude:b.latitude,longitude:b.longitude},{latitude:e.latitude,longitude:e.longitude}];return ye.a.getDistanceBetween(t[0],t[1])<=1e3}(t.location)?(e=!0,Object(n.jsx)(Fe,{title:t.name,id:t.id,barCreatorId:t.creatorId,description:t.description,photo:t.photo},t.id)):Object(n.jsx)(n.Fragment,{})})),!e&&Object(n.jsx)("h1",{id:"test__no_bar",children:"Sorry, there no bars are near you. Start your own!"})]})]})})},ze=(a(142),Object(y.a)({root:{maxWidth:345,minWidth:345,marginTop:15,marginBottom:15,backgroundColor:"#311f34",boxShadow:"4px 4px 5px 0px rgba(50, 50, 50, 0.9)"},media:{height:250},bar__button:{color:"#FFDC14","&:hover":{background:"#FFDC14",color:"#311f34",boxShadow:"10px 10px 99px 6px #ffdc14"}}}));var Me=function(e){var t=e.id,a=e.name,o=e.tableCreatorId,i=e.customTableImage,r=e.description,l=Object(d.g)().barId,b=Object(d.f)(),u=j(),h=Object(s.a)(u,1)[0].idToken,p=Object(c.useState)(null),m=Object(s.a)(p,2),O=m[0],f=m[1],g=ze();Object(c.useEffect)((function(){v.collection("bars").doc(l).collection("tables").doc(t).collection("usersAtTable").onSnapshot((function(e){f(e.docs.map((function(e){return e.data()})))}))}),[]);var x,_,y=function(){b.push("/bar/".concat(l,"/table/").concat(t))};return Object(n.jsxs)(we.a,{className:g.root,children:[Object(n.jsxs)(Ce.a,{onClick:y,children:[Object(n.jsx)(Te.a,{className:g.media,image:i||"https://images.unsplash.com/photo-1575444758702-4a6b9222336e?ixid=MXwxMjA3fDB8MHxzZWFyY2h8M3x8YmFyfGVufDB8fDB8&ixlib=rb-1.2.1&w=1000&q=80"}),Object(n.jsxs)(Ie.a,{children:[Object(n.jsx)(R.a,{gutterBottom:!0,variant:"h5",component:"h2",children:a}),Object(n.jsx)(R.a,{variant:"body1",color:"textSecondary",component:"p",children:r}),Object(n.jsx)(R.a,{variant:"body2",color:"textSecondary",component:"p",children:"".concat(null===O||void 0===O?void 0:O.length," patron").concat(1===(null===O||void 0===O?void 0:O.length)?"":"s"," at this table")})]})]}),Object(n.jsxs)(Se.a,{children:[Object(n.jsx)(A.a,{className:g.bar__button,size:"small",color:"primary",onClick:y,children:"Join Table"}),0===(null===O||void 0===O?void 0:O.length)&&(x=o,_=h,x===_)&&Object(n.jsx)(A.a,{className:g.bar__button,size:"small",color:"primary",onClick:function(){window.confirm("Are you sure you want to delete your table?")&&v.collection("bars").doc(l).collection("tables").doc(t).delete()},children:"Delete Table"})]})]})},Ve=a(95),Ue=a.n(Ve);a(143);var Ge=function(){var e=j(),t=Object(s.a)(e,2),a=t[0].idToken,o=t[1],i=Object(d.f)(),r=Object(d.g)().barId,l=Object(c.useState)(null),b=Object(s.a)(l,2),u=b[0],h=b[1],p=Object(c.useState)([]),m=Object(s.a)(p,2),O=m[0],f=m[1],g=Object(c.useState)(""),x=Object(s.a)(g,2),_=x[0],k=x[1],N=Object(c.useState)(null),w=Object(s.a)(N,2),C=w[0],S=w[1],I=Object(c.useState)(""),T=Object(s.a)(I,2),D=T[0],F=T[1],B=Object(c.useState)(""),E=Object(s.a)(B,2),L=E[0],z=E[1];Object(c.useEffect)((function(){r&&v.collection("bars").doc(r).onSnapshot((function(e){return h(e.data())})),v.collection("bars").doc(r).collection("tables").orderBy("name","asc").onSnapshot((function(e){return f(e.docs.map((function(e){return{id:e.id,name:e.data().name,creatorId:e.data().creatorId,customTableImage:e.data().customTableImage,description:e.data().description}})))})),o({type:ne,at_bar:r,at_table:null})}),[r]);var M=function(){i.push("/")},V=Object(y.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),width:"25ch"}},typography:{padding:e.spacing(2)},link:{display:"flex"},icon:{marginRight:e.spacing(.5),width:20,height:20},bar__button:{backgroundColor:"#311f34",color:"#FFDC14","&:hover":{background:"#FFDC14",color:"#311f34"}}}}))(),U=function(){S(null)},G=Boolean(C),Y=G?"simple-popover":void 0;return Object(n.jsxs)("div",{className:"street",children:[Object(n.jsxs)(Re.a,{"aria-label":"breadcrumb",className:"breadCrumbs",children:[Object(n.jsxs)(Be.a,{color:"inherit",onClick:M,className:V.link,children:[Object(n.jsx)(We.a,{className:V.icon}),"Bars Nearby"]}),Object(n.jsxs)(Be.a,{color:"inherit",onClick:M,className:V.link,children:[Object(n.jsx)(Ue.a,{className:V.icon}),null===u||void 0===u?void 0:u.name]}),Object(n.jsx)(A.a,{className:V.bar__button,id:"form_close",variant:"contained",color:"primary",onClick:function(e){S(e.currentTarget)},disableFocusRipple:!0,disableRipple:!0,children:"Grab a table"})]}),Object(n.jsx)(W.a,{id:Y,open:G,anchorEl:C,onClose:U,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(n.jsx)(R.a,{className:V.typography,children:Object(n.jsxs)("form",{className:V.root,noValidate:!0,autoComplete:"off",children:[Object(n.jsx)(re.a,{id:"outlined-basic",label:"Enter your table's name",variant:"outlined",onChange:function(e){return F(e.target.value)},value:D}),Object(n.jsx)(re.a,{id:"outlined-basic",label:"Enter a short description",variant:"outlined",onChange:function(e){return k(e.target.value)},value:_}),Object(n.jsx)(re.a,{id:"outlined-basic",label:"Enter an image URL",variant:"outlined",onChange:function(e){return z(e.target.value)},value:L}),Object(n.jsx)("div",{children:Object(n.jsx)("button",{id:"input__bar_box",type:"submit",onClick:function(e){e.preventDefault();var t=["Welcome to Deh Bar-Bar","Discussing Michelle Oboma's arms","Bar Bar Binks","What is this? A table for ants!?","Awwwwwwlrighty then!","Join knights who say 'NI!'","How about that Limp Bizkit?","Do you like things and stuff? We do!","Sharks & frickin' laser beams","Go for Broke, or something....","I ate a sock cuz peeps on the Net told me to","They drank life before spitting it out","Come on Barbie let's go party!","Shenanigans Shenanigans Shenanigans Shenanigans, ","The blue parrot drove by the hitchhiking mongoose","Flying fish flew by the space station","#Drunk #Drunk #Drunk #Drunk #Drunk #Drunk","Girls, Girls, Girls! - Motley Crew \ud83e\udd1f\ud83c\udfb6","Tomorrow is a storyteller without equal","Insignificance loves to love","The legend of the raven's roar visits Japan in the winter"];D?(v.collection("bars").doc(r).collection("tables").add({name:D,creatorId:a,customTableImage:L||null,description:_||t[Math.floor(Math.random()*t.length)]}),F(""),k(""),z(""),U()):alert("Your table must have a name")}})})]})})}),Object(n.jsx)("div",{className:"table_list",children:O.map((function(e){return Object(n.jsx)(Me,{id:e.id,name:e.name,tableCreatorId:e.creatorId,customTableImage:e.customTableImage,description:e.description},e.id)}))})]})};a(144);var Ye=function(){var e=j(),t=Object(s.a)(e,1)[0].user;return function(){var e,t,a=j(),n=Object(s.a)(a,1)[0],o=n.user,i=n.at_bar,r=n.at_table,l=n.last_bar,d=n.last_table;Object(c.useEffect)(Object(O.a)(m.a.mark((function a(){var n,c;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!o){a.next=19;break}if(!i){a.next=8;break}return a.next=4,v.collection("bars").doc(i).get();case 4:n=a.sent,e=n.data().name,a.next=9;break;case 8:e=null;case 9:if(!r){a.next=16;break}return a.next=12,v.collection("bars").doc(i).collection("tables").doc(r).get();case 12:c=a.sent,t=c.data().name,a.next=17;break;case 16:t=null;case 17:v.collection("users").doc(o.uid).update({at_bar:i,at_bar_name:e,at_table:r,at_table_name:t,last_bar:l,last_table:d}),!r&&d&&v.collection("bars").doc(l).collection("tables").doc(d).collection("usersAtTable").doc(o.uid).delete();case 19:case"end":return a.stop()}}),a)}))),[i,r])}(),function(){var e,t=j(),a=Object(s.a)(t,1)[0],n=a.user,o=a.last_bar,i=a.last_table,r=null===(e=h.a.auth().currentUser)||void 0===e?void 0:e.uid;Object(c.useEffect)((function(){h.a.database().ref("users/"+r).update({last_bar:o,last_table:i})}),[i]),Object(c.useEffect)((function(){if(null!=n){var e=h.a.database().ref("/users/"+r),t={state:"offline",last_changed:h.a.database.ServerValue.TIMESTAMP},a={state:"online",last_changed:h.a.database.ServerValue.TIMESTAMP};h.a.database().ref(".info/connected").on("value",(function(n){0!=n.val()&&e.onDisconnect().update(t).then((function(){e.update(a)}))}));var c=h.a.firestore().doc("/users/"+r),o={state:"offline",last_changed:h.a.firestore.FieldValue.serverTimestamp()},i={state:"online",last_changed:h.a.firestore.FieldValue.serverTimestamp()};h.a.database().ref(".info/connected").on("value",(function(n){0!=n.val()?e.onDisconnect().update(t).then((function(){e.update(a),c.update(i)})):c.update(o)}))}}),[n])}(),Object(n.jsx)("div",{className:"app",children:Object(n.jsx)(l.a,{children:t?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(Q,{}),Object(n.jsx)("div",{className:"app__body",children:Object(n.jsxs)(d.c,{children:[Object(n.jsx)(d.a,{path:"/bar/:barId/table/:tableId",children:Object(n.jsx)(ve,{})}),Object(n.jsx)(d.a,{path:"/bar/:barId",children:Object(n.jsx)(Ge,{})}),Object(n.jsx)(d.a,{path:"/",children:Object(n.jsx)(Le,{})})]})})]}):Object(n.jsx)(Ne,{})})})};r.a.render(Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(u,{initialState:{user:null,userLocation:null,idToken:null,at_bar:null,at_table:null,last_bar:null,last_table:null},reducer:ce,children:Object(n.jsx)(Ye,{})})}),document.getElementById("root"))},85:function(e,t,a){}},[[145,1,2]]]);
//# sourceMappingURL=main.ec4c4625.chunk.js.map